<div id="form-editor">
    <h2>Add New Frequency</h2>
    <form id="frequencyForm">
        <input type="text" name="name" placeholder="Name (e.g., Local Repeater)" required>
        <select name="type" required>
            <option value="FM">NFM</option>
            <option value="SSB">FM/Telem</option>
            <option value="DMR">DMR</option>
            <option value="SSB">AM</option>
        </select>
        
        <div class="grid">
            <input type="text" name="rx_freq" placeholder="RX Freq (e.g., 145.250 MHz)" required>
            <input type="text" name="tx_freq" placeholder="TX Freq" required>
            <input type="text" name="offset" placeholder="Offset (e.g., -0.600 MHz)">
        </div>

        <div class="grid">
            <input type="text" name="ctcss_tone" placeholder="CTCSS (e.g., 110.9 Hz)">
            <input type="text" name="dcs_code" placeholder="DCS Code">
            <input type="number" name="color_code" placeholder="Color Code (DMR)">
        </div>

        <div class="grid" id="dmr-fields">
            <input type="text" name="talkgroup" placeholder="Talkgroup (DMR)">
            <input type="number" name="timeslot" placeholder="Timeslot (DMR)">
        </div>

        <input type="text" name="location" placeholder="Location">
        <textarea name="notes" placeholder="Notes"></textarea>
        <button type="submit">Save</button>
    </form>
</div>

<script>
    // Dynamic form handling
    document.getElementById('frequencyForm').addEventListener('submit', (e) => {
        e.preventDefault();
        const formData = new FormData(e.target);
        const newEntry = Object.fromEntries(formData.entries());
        
        // Clean empty fields
        for (const key in newEntry) {
            if (newEntry[key] === '') newEntry[key] = null;
        }

        // Add to JSON and save
        fetch('data/frequencies.json')
            .then(response => response.json())
            .then(data => {
                data.push(newEntry);
                updateGitHubFile(JSON.stringify(data, null, 2)); // Reuse GitHub API function
            });
    });

    // Show/hide DMR fields based on type selection
    document.querySelector('[name="type"]').addEventListener('change', (e) => {
        document.getElementById('dmr-fields').style.display = 
            (e.target.value === 'DMR') ? 'block' : 'none';
    });
</script>
